<div class="container">
  <!-- Header -->
  <div class="header">
    <div class="back-button" (click)="goBack()">
      <i class="fa-solid fa-arrow-left"></i> 
    </div>
    <h2 class="title">New Item</h2>
    <div class="actions">
      <button class="btn save" (click)="onSubmit()" [disabled]="!vehicleForm.valid">Save</button>
      <button class="btn delete" (click)="deleteVehicle()">Delete</button>
    </div>
  </div>
  <hr />

  <!-- Content Section -->
  <div class="content">
    <!-- Left Column: Form Section -->
    <form (ngSubmit)="onSubmit()" #vehicleForm="ngForm" class="form-section">
      <div class="form-group">
        <label for="name">Name<span class="required">*</span></label>
        <input type="text" id="name" [(ngModel)]="vehicles.name" name="name" required />
      </div>
      <div class="form-group">
        <label for="category">Category<span class="required">*</span></label>
        <select
          [(ngModel)]="vehicles.category"
          (click)="loadCategories()"
          (focus)="loadCategories()"
          (change)="onCategoryChange($event)"
        >
          <option value="">Select a category</option>
          <option *ngFor="let category of categories" [value]="category">
            {{ category }}
          </option>
          <option value="add-new">Add New Category</option>
        </select>
      </div>
<!-- Modal for adding new category -->
<div *ngIf="showModal" class="modal-overlay">
  <div class="modal">
    <div class="modal-header">
      <h3>Add New Category</h3>
      <button type="button" class="close-button" (click)="closeModal()">X</button>
    </div>
    <div class="modal-body">
      <input type="text" id="newCategory" [(ngModel)]="newCategory" placeholder="Enter category name" />
      <button type="button" (click)="addNewCategory()">Add Category</button>
    </div>
  </div>
</div>

      <div class="form-group">
        <label for="plateNumber">Plate Number<span class="required">*</span></label>
        <input type="text" id="plateNumber" [(ngModel)]="vehicles.plateNumber" name="plateNumber" required />
      </div>
      <div class="form-group">
        <label for="capacity">Capacity<span class="required">*</span></label>
        <input type="number" id="capacity" [(ngModel)]="vehicles.capacity" name="capacity" required />
      </div>
      <div class="form-group">
        <label for="status">Status<span class="required">*</span></label>
        <select id="status" [(ngModel)]="vehicles.status" name="status" required>
          <option value="Available">Available</option>
          <option value="Booked">ฺBooked</option>
          <option value="Maintenance">Maintenance</option>
        </select>
      </div>
      <div class="form-group">
        <label for="maintenanceDate">Maintenance Date</label>
        <input type="date" id="maintenanceDate" [(ngModel)]="vehicles.maintenanceDate" name="maintenanceDate" />
      </div>
    </form>

    <!-- Right Column: Image & Form Data -->
    <div class="right-column">
      <div class="image-section">
        <div class="image-placeholder" (click)="onBrowseImage()">
          <!-- ถ้ามีการเลือกภาพแล้ว ให้แสดงภาพที่เลือก -->
          <img *ngIf="previewImage" [src]="previewImage" alt="Selected Image" />
          <!-- ถ้ายังไม่มีการเลือกภาพ แสดงข้อความและไอคอน -->
          <div *ngIf="!previewImage" class="browse-container">
            <span class="browse-text">Browse image</span>
            <img class="upload-icon" src="upload-icon.png" alt="Upload Icon" />
          </div>
        </div>
        <!-- ปุ่มเลือกไฟล์ที่ซ่อนอยู่ -->
        <input
          type="file"
          id="imageUpload"
          (change)="onImageSelected($event)"
          accept="image/*"
          hidden
        />
        <!-- ถ้าผู้ใช้เลือกภาพแล้ว แสดงปุ่มถังขยะ -->
        <div *ngIf="previewImage" class="trash-container" (click)="removeImage()">
          <img class="trash-icon" src="upload-icon.png" alt="Delete Image" />
        </div>
      </div>

      <!-- Form Data Container จะถูกแสดงเมื่อกรอกครบ -->
      <div class="form-data-container" *ngIf="isFormValid()">
        <h3>{{ vehicles.name }}</h3>
        <ul>
          <li>
            <strong>Category</strong>
            <span>{{ vehicles.category }}</span>
          </li>
          <li>
            <strong>Plate Number</strong>
            <span>{{ vehicles.plateNumber }}</span>
          </li>
          <li>
            <strong>Capacity</strong>
            <span>{{ vehicles.capacity }}</span>
          </li>
          <li>
            <strong>Status</strong>
            <span [ngClass]="getStatusClass(vehicles.status)">
              {{ vehicles.status }}
            </span>
          </li>
          <li>
            <strong>Maintenance Date</strong>
            <span>{{ vehicles.maintenanceDate }}</span>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
